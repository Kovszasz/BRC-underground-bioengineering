underground_milp={'ascb_L_p': 'NA', 'cit_c': 'NA', 'C02126_c': 'NA', 'gly_c': {2.0: ['u0097', 'u0689']}, '3mop_c': 'NA', 'ac_c': 'NA', 'etoh_c': 'NA', 'bz_c': 'NA', 'phe_L_c': 'NA', 'ser_D_c': 'NA', '2obut_c': 'NA', 'acon_C_c': 'NA', 'bzal_c': 'NA', 'lac_L_c': {1.0: ['u0293']}, 'fru_c': 'NA', 'bnol_c': {1.0: ['u0009']}, 'succ_c': 'NA', 'C01904_c': 'NA', 'tartr_D_c': {1.0: ['u0095']}, 'acon_T_c': 'NA', 'glyc_c': {4.0: ['u0065', 'u0134', 'u0214', 'u0300']}, 'mal_L_c': 'NA', 'for_c': 'NA', 'tyr_L_c': 'NA', 'ghb_c': 'NA', 'thr_L_c': 'NA', 'pro_L_c': 'NA', 'glu_D_c': 'NA', 'glcr_c': 'NA', 'C11714_c': 'NA', 'hqn_c': 'NA', 'fum_c': 'NA', 'xylt_c': 'NA', 'sbt_D_e': 'NA', 'glcn_c': 'NA', 'C11713_c': 'NA', 'C01719_c': 'NA', 'ala_L_c': 'NA', 'mal_D_c': 'NA', '3mob_c': 'NA', '3hbut_R_c': 'NA', 'asp_D_c': 'NA', 'lac_D_c': 'NA', 'asp_L_c': 'NA', 'oxa_c': 'NA', '15dap_c': 'NA', '3hpp_c': {1.0: ['u0630']}, 'ser_L_c': 'NA', 'C01845_c': {2.0: ['u0008', 'u0227']}, 'ala_D_c': 'NA', 'abt_c': 'NA', '4mop_c': 'NA', 'lys_L_c': 'NA', 'tartr_L_c': 'NA', 'acald_c': 'NA', 'glu_L_c': 'NA', 'alein_c': 'NA', '12ppd_R_c': 'NA', 'ptrc_c': 'NA', '4crsol_c': 'NA', 'ppa_c': 'NA', '12ppd_S_c': {1.0: ['u0293']}, 'C01380_c': {1.0: ['u0228']}, 'phenol_c': 'NA'}
heterologous_milp={'asp_L_c': 'NA', 'CPD__45__1092_c': {2.0: ['MetaCyc464', 'MetaCyc2825']}, '12ppd_S_c': {2.0: ['MetaCyc216', 'MetaCyc5291']}, 'ala_L_c': 'NA', 'for_c': 'NA', 'lys_L_c': {1.9999999999999862: ['MetaCyc1033', 'MetaCyc3210']}, 'THIOGLYCOLATE_c': 'NA', 'thr_L_c': {1.0: ['MetaCyc3481']}, 'ppa_c': 'NA', 'CPD__45__842_c': 'NA', 'ETHYLACETATE_c': {1.0: ['MetaCyc3930']}, 'glu_L_c': 'NA', 'TOLUENE_c': 'NA', '_4__45__NITROANILINE_c': 'NA', 'ISOBUTANOL_c': 'NA', 'BENZENE__45__NO2_c': 'NA', 'ghb_c': {1.0: ['MetaCyc3481']}, 'glcr_c': 'NA', 'ser_L_c': 'NA', 'VANILLIN_c': {6.0000000000000036: ['MetaCyc2827', 'MetaCyc3296', 'MetaCyc3449', 'MetaCyc3452', 'MetaCyc5571', 'MetaCyc5689']}, 'acald_c': 'NA', 'BENZALDEHYDE_c': {2.999999999999402: ['MetaCyc464', 'MetaCyc3984', 'MetaCyc4218']}, 'phe_L_c': {2.0: ['MetaCyc220', 'MetaCyc5293']}, 'ACETONE_c': {2.0: ['MetaCyc3797', 'MetaCyc3798']}, 'CHLOROBENZENE_c': 'NA', '4crsol_c': {2.0: ['MetaCyc220', 'MetaCyc5293']}, 'GLYCOL_c': {2.0: ['MetaCyc4266', 'MetaCyc5057']}, 'RIBITOL_c': {2.0: ['MetaCyc1005', 'MetaCyc4716']}, 'PENTACHLOROPHENOL_c': 'NA', 'ETHYLBENZENE_c': 'NA', 'ala_D_c': 'NA', 'CPD__45__843_c': 'NA', 'CPD__45__347_c': {2.0: ['MetaCyc1824', 'MetaCyc5387']}, 'TRICHLOROETHENE_c': 'NA', 'CPD__45__623_c': 'NA', 'PROPANOL_c': {2.0: ['MetaCyc3401', 'MetaCyc3743']}, 'BUTANOL_c': {1.0: ['MetaCyc4288']}, 'CPD__45__7032_c': {2.0: ['MetaCyc2619', 'MetaCyc2621']}, 'METHYLAMINE_c': {2.0000000000000018: ['MetaCyc3275', 'MetaCyc5411']}, 'fru_c': {2.0: ['MetaCyc216', 'MetaCyc5291']}, 'glyc_c': {1.9999999999999984: ['MetaCyc216', 'MetaCyc5291']}, 'CPD__45__614_c': 'NA', 'TETRACHLOROETHENE_c': 'NA', 'CPD__45__8131_c': 'NA', 'Citronellals_c': 'NA', 'glu_D_c': 'NA', 'NAPHTHALENE_c': 'NA', 'mal_D_c': {1.9999999999999445: ['MetaCyc1140', 'MetaCyc5716']}, 'tartr_D_c': {1.0: ['MetaCyc4672']}, 'acon_T_c': 'NA', 'CPD__45__10866_c': 'NA', 'tartr_L_c': {1.0: ['MetaCyc547']}, 'CPD__45__109_c': 'NA', 'mal_L_c': 'NA', 'succ_c': 'NA', 'CPD__45__335_c': {2.0: ['MetaCyc2869', 'MetaCyc3798']}, '_2__45__AMINOPHENOL_c': 'NA', 'lac_L_c': {1.0: ['MetaCyc5781']}, 'hqn_c': {0.9999999999999984: ['MetaCyc1578']}, '15dap_c': {2.0: ['MetaCyc2644', 'MetaCyc3481']}, 'fum_c': 'NA', '4mop_c': {2.0: ['MetaCyc220', 'MetaCyc5293']}, 'meoh_c': {1.9605671015519297e-13: []}, '12ppd_R_c': {2.0: ['MetaCyc1066', 'MetaCyc5719']}, 'PENTANOL_c': 'NA', 'glcn_c': 'NA', 'lac_D_c': 'NA', 'tyr_L_c': {2.0: ['MetaCyc220', 'MetaCyc5293']}, 'CPD__45__6442_c': {2.0: ['MetaCyc1833', 'MetaCyc2425']}, 'XYLITOL_c': {4.0: ['MetaCyc1388', 'MetaCyc2771', 'MetaCyc4716', 'MetaCyc4778']}, 'ascb_L_p': 'NA', '3hpp_c': {1.0: ['MetaCyc4901']}, 'CPD__45__883_c': 'NA', 'PROPENE_c': 'NA', 'CPD__45__13346_c': {2.0: ['MetaCyc3491', 'MetaCyc4288']}, 'ADIPATE_c': 'NA', 'BENZOATE_c': {2.0000000000000018: ['MetaCyc464', 'MetaCyc3984']}, 'CPD__45__8923_c': 'NA', 'GERANIOL_c': {0.9999999999999927: ['MetaCyc3231']}, 'CPD__45__9937_c': 'NA', 'gly_c': {1.0: ['MetaCyc3921']}, 'oxa_c': {1.0000000000000018: ['MetaCyc5432']}, 'CPD__45__19003_c': {2.0: ['MetaCyc802', 'MetaCyc3248']}, 'ACRYLONITRILE_c': 'NA', '3mop_c': {2.0: ['MetaCyc3481', 'MetaCyc5550']}, 'etoh_c': 'NA', 'SORBITOL_c': {1.0: ['MetaCyc407']}, 'COUMARIN_c': {7.000000000000165: ['MetaCyc464', 'MetaCyc684', 'MetaCyc2155', 'MetaCyc2244', 'MetaCyc2832', 'MetaCyc2836', 'MetaCyc2839']}, 'NAPHTHOL_c': 'NA', 'CPD__45__258_c': 'NA', 'GERANIAL_c': {1.9999999999999116: ['MetaCyc447', 'MetaCyc2894']}, '2obut_c': {1.0: ['MetaCyc3210']}, 'ac_c': 'NA', 'ANILINE_c': {0.9999999999999978: ['MetaCyc2754']}, 'ACRYLAMIDE_c': 'NA', 'ACROLEIN_c': 'NA', 'CPD__45__10896_c': 'NA', 'fald_c': {0.9999999999999957: ['MetaCyc5719']}, 'pro_L_c': {2.0: ['MetaCyc220', 'MetaCyc5293']}, 'CPD__45__681_c': 'NA', 'ISO__45__PROPANOL_c': {2.9999999999999982: ['MetaCyc187', 'MetaCyc791', 'MetaCyc3797']}, 'ETHYLENE__45__CMPD_c': {1.0: ['MetaCyc3248']}, 'PHENOL_c': {0.9999999999999437: ['MetaCyc3455']}, 'ser_D_c': 'NA', 'acon_C_c': 'NA', 'CPD__45__844_c': {1.0: ['MetaCyc1178']}, 'cit_c': 'NA', 'CPD__45__7035_c': {1.999999999999509: ['MetaCyc482', 'MetaCyc2624']}, '3mob_c': 'NA', 'CPD__45__845_c': {1.0: ['MetaCyc1828']}, 'O__45__DICHLOROBENZENE_c': 'NA'}

HET={}
results=[]
for i in range(1,9):
     results.append(binary_loader(str(i)))

for result in results:
    for r in result.keys():
        if r not in HET.keys():
            HET[r]=result[r]
        else:
            HET[r]=HET[r]+result[r]
#ptr=binary_loader('PtrcStat')
#HET.update(ptr)

N={}
with open('heterologous_yield_result.txt','r') as n:
    for i in n:
        i=white_space_remover(i)
        i=i.split(',')
        N[i[0]]=float(i[1])

for result in results:
    for r in result.keys():                 
        if r not in HET.keys(): 
            HET[r]=result[r]    
        else:         
            HET[r]=HET[r]+result[r]

new_yield=[]
yield_increment=[]

result_ny=[]
result_yi=[]
for seed in range(1000):
    new_yield=0
    yield_increment=0
    for metabolite in HET.keys():
        if N[metabolite]<1e-4:
            if HET[metabolite][seed]>1e-4:
                new_yield=new_yield+1
        else:
            if (HET[metabolite][seed]/N[metabolite])-1>0.05:
                yield_increment=yield_increment+1
    result_ny.append(new_yield)
    result_yi.append(yield_increment)

hetstat = open('heterologous_stat_histogram.csv','w')
hetstat.write('New_yield , Yield_increment\n')

for seed in range(1000):
    a=str(result_ny[seed])+','+str(result_yi[seed])+'\n'
    hetstat.write(a)
    print(a)
hetstat.close()
